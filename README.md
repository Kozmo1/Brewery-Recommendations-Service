# Brewery-Recommendations-Service

Created by Joel Attard, Shahyar Fida, Mike Kraemer, Julia Lebedzeva

This project is a Node.js-based microservice for product recommendations in an e-commerce application, developed as part of a group project for Open Source Web Programming at Conestoga College. It handles personalized recommendations based on user taste profiles and product-based suggestions, pulling data from the Brewery Database Service via RESTful APIs. We built it with TypeScript, Express, and Jest to keep it solid, secure, and testable—aiming for 90%+ branch coverage. The service uses `dotenv-safe` to load environment variables from `.env.local` by default or based on `NODE_ENV`. Key settings include the server port (default: 3004), Brewery API URL (default: http://localhost:5089), and a JWT secret for auth. The `RecommendationsController` class runs the show, using Axios for API calls.

To get started, clone the repo from `C:\git\Brewery-Recommendations-Service` (or your fork), then run `npm install` to grab dependencies like `express`, `axios`, `jsonwebtoken`, and `dotenv-safe`. For dev work, add `typescript`, `jest`, `@types/*` packages, and `ts-node` with `npm install --save-dev`. Set up a `.env.local` file with `PORT`, `JWT_SECRET`, `BREWERY_API_URL`, and `NODE_ENV`, using `.env.example` as a guide. Start the service with `npm start` (assuming `ts-node src/index.ts`), or compile with `npm run build` and run `node dist/index.js`. Test it with `npm run test` to hit Jest with coverage—shooting for 100%.

The project’s laid out with `src/config/config.ts` for env setup, `src/controllers/recommendationController.ts` for the core logic, `src/middleware/auth.ts` for JWT checks, and `src/index.ts` to kick things off. Tests are in `src/config/__tests__/config.test.ts` and `src/controllers/__tests__/recommendationController.test.ts`, mocking Axios. Below are the endpoints, all under `/recommendations` and expecting JSON content type. Routes need a Bearer token in the `Authorization` header.

1. `GET /` - Gets personalized or default recommendations (authenticated). Example request: `GET /recommendations` with header `Authorization: Bearer <token>`. Success response (200, authenticated): `{"message": "Personalized recommendations", "recommendations": [{"Id": 1, "Name": "Hoppy Beer", "TasteProfile": {"PrimaryFlavor": "Hoppy"}, "StockQuantity": 10}]}`. Success response (200, no user): `{"message": "Default recommendations", "recommendations": [{"Id": 1, "Name": "Beer 1", "TasteProfile": {}, "StockQuantity": 10}]}`. Error (500): `{"message": "Error fetching recommendations", "error": "Network error"}`.
2. `GET /:productId` - Gets recommendations based on a product (authenticated). Example request: `GET /recommendations/1` with header `Authorization: Bearer <token>`. Success response (200): `{"message": "Related product recommendations", "recommendations": [{"Id": 2, "Name": "Hoppy Ale", "TasteProfile": {"PrimaryFlavor": "Hoppy"}, "StockQuantity": 5}]}`. Error (404): `{"message": "Product not found"}`.
